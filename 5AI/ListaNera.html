<link rel="stylesheet" href="listanera.css">
<html>
<head>
    <script>
        let parseJSON= [] //variabile salvata in globale per essere utilizzata anche nelle altre funzioni

        //funzione per fare solo una XMLhttpReq
        function caricaDati() {
            const richiesta = new XMLHttpRequest()
            richiesta.open("GET", "https://belloniandrea.github.io/LavoriBelloni/5AI/ListaNera.json", true)
            richiesta.send()

            richiesta.onload = function () {
                parseJSON = JSON.parse(richiesta.responseText);
                //console.log(parseJSON)
            }
        }

        function lettura(){
                //creazione tabella
                let tabella= document.createElement("table")

                const chiavi=Object.keys(parseJSON[0])//chiavi del primo oggetto del file JSON per fare l'intestazione
                
                //creazione della prima riga di intestazione con le chiavi e appensione di essa alla tabella
                let intestazioneRow=document.createElement("tr")
                for(let i=0; i<chiavi.length; i++){
                    let intestazione=document.createElement("th");
                    intestazione.textContent= chiavi[i];
                    intestazioneRow.appendChild(intestazione)  
                }
                tabella.appendChild(intestazioneRow)

                //creazione contenuto tabella
                
                for(let i=0; i<parseJSON.length ;i++){
                    let righe= document.createElement("tr");
                    for(let j=0; j<chiavi.length; j++ ){
                        let colonne= document.createElement("td")
                        colonne.textContent = colonne.textContent = parseJSON[i][chiavi[j]] //prende valore della chiave al posto "j" dell'oggetto "i"
                        righe.appendChild(colonne)
                    }
                tabella.appendChild(righe)
                }   
                let output= document.getElementById("output")
                output.appendChild(tabella);
     }
    

    function maggiorenni(){ 
        console.log(parseJSON)
                let maggiorenni="" 
                for(let i=0;i<parseJSON.length; i++){
                    if(parseJSON[i]["età"]>18){
                        maggiorenni += parseJSON[i]["cognome"] + " " + parseJSON[i]["età"] + "<br>"
                    }

                }
                let output=document.getElementById("outputM").innerHTML = maggiorenni
            }

    function ricerca(){
        let lettera=document.getElementById("ricerca").value
        let cognomi="I cognomi che iniziano con " + lettera + " sono: "
        for (let i = 0; i < parseJSON.length; i++) {
            if(parseJSON[i]["cognome"].startsWith(lettera)) //il metodo startsWith restituisce true o false in base alla variabile a cui si applica il metodo
            cognomi += parseJSON[i]["cognome"] +"<br>"
        }
        let output=document.getElementById("outputC").innerHTML = cognomi
    }

    function generazione(){
        let anno = document.getElementById("eta").value;
        let generazione = "";
        if (anno >= 1901 && anno <= 1927) {
            generazione = "Appartieni alla Greatest Generation (1901-1927)";
        } else if (anno >= 1928 && anno <= 1945) {
            generazione = "Appartieni alla Generazione Silenziosa (1928-1945)";
        } else if (anno >= 1946 && anno <= 1964) {
            generazione = "Appartieni ai Baby Boomers (1946-1964)";
        } else if (anno >= 1965 && anno <= 1980) {
            generazione = "Appartieni alla Generazione X (1965-1980)";
        } else if (anno >= 1981 && anno <= 1996) {
            generazione = "Appartieni ai Millenials (1981-1996)";
        } else if (anno >= 1997 && anno <= 2012) {
            generazione = "Appartieni alla Generazione Z (1997-2012)";
        } else if (anno >= 2013) {
            generazione = "Appartieni alla Generazione Alpha (dal 2013 in poi)";
        } else {
            generazione = "Anno di nascita non valido";
        }
            let output=document.getElementById("outputG").innerHTML = generazione
    }
    </script>
    
</head>


<body onload="caricaDati()">

    <h1>Lista Nera</h1>
   <p id="output">  </p>
    <input type="button" value="schiaccia" onclick="lettura()">
    <label for="ricerca">inserisci la lettera dei cognomi da cercare</label>
    <select id="ricerca" name="ricerca">
     <option value="A">A</option>
     <option value="B">B</option>
     <option value="C">C</option>
     <option value="D">D</option>
     <option value="E">E</option>
     <option value="F">F</option>
     <option value="G">G</option>
     <option value="H">H</option>
     <option value="I">I</option>
     <option value="J">J</option>
     <option value="K">K</option>
     <option value="L">L</option>
     <option value="M">M</option>
     <option value="N">N</option>
     <option value="O">O</option>
     <option value="P">P</option>
     <option value="Q">Q</option>
     <option value="R">R</option>
     <option value="S">S</option>
     <option value="T">T</option>
     <option value="U">U</option>
     <option value="V">V</option>
     <option value="W">W</option>
     <option value="X">X</option>
     <option value="Y">Y</option>
     <option value="Z">Z</option>
  </select>
  <input type="button" value="Ricerca Cognomi" onclick="ricerca()">
  <p id="outputC"> </p>

  <input type="number" id="eta" name="età">
  <input type="button" value=" Inserisci il tuo anno di nascita e scopri la tua generazione" onclick="generazione()">
  <p id="outputG"></p>

  <input type="button" value="stampa maggiorenni" onclick="maggiorenni()">
  <p id="outputM"> </p>
  
</body>

</html>





